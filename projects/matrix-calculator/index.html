<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Power Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .input-section {
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
            font-family: monospace;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .error {
            color: red;
            margin-top: 10px;
        }
        input[type="number"] {
            width: 100px;
            padding: 5px;
            margin-bottom: 10px;
        }
        .instructions {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Matrix Power Calculator</h1>
    
    <div class="instructions">
        <h3>Instructions:</h3>
        <p>1. Enter Matrix A (n×n matrix) with each row on a new line, values separated by spaces</p>
        <p>2. Enter Vector B (1×n vector) with values separated by spaces</p>
        <p>3. Enter the value of k (number of iterations)</p>
        <p>Example format:<br>
        Matrix A:<br>
        1.15 -0.15 0<br>
        -0.15 1.15 -0.15<br>
        0 -0.15 1.15<br>
        <br>
        Vector B:<br>
        0.8965695 1.4506815 1.4506815</p>
    </div>

    <div class="input-section">
        <label for="matrixA">Matrix A:</label><br>
        <textarea id="matrixA" placeholder="Enter Matrix A (space-separated values, one row per line)"></textarea>
    </div>

    <div class="input-section">
        <label for="vectorB">Vector B:</label><br>
        <textarea id="vectorB" placeholder="Enter Vector B (space-separated values)"></textarea>
    </div>

    <div class="input-section">
        <label for="kValue">Value of k:</label><br>
        <input type="number" id="kValue" min="1" value="50">
    </div>

    <button onclick="calculateBk()">Calculate B_k</button>

    <div id="result"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.js"></script>
    <script>
        function parseMatrix(str) {
            return str.trim().split('\n').map(row => 
                row.trim().split(/\s+/).map(Number)
            );
        }

        function parseVector(str) {
            return str.trim().split(/\s+/).map(Number);
        }

        function calculateBk() {
            try {
                // Get input values
                const matrixAStr = document.getElementById('matrixA').value;
                const vectorBStr = document.getElementById('vectorB').value;
                const k = parseInt(document.getElementById('kValue').value);

                // Parse inputs
                const matrixA = parseMatrix(matrixAStr);
                const vectorB = parseVector(vectorBStr);

                // Validate inputs
                if (!matrixA.length || !matrixA[0].length) {
                    throw new Error('Matrix A is empty or invalid');
                }
                if (!vectorB.length) {
                    throw new Error('Vector B is empty or invalid');
                }
                if (matrixA.length !== matrixA[0].length) {
                    throw new Error('Matrix A must be square');
                }
                if (vectorB.length !== matrixA[0].length) {
                    throw new Error('Vector B length must match Matrix A dimensions');
                }

                // Convert to mathjs matrices
                const A = math.matrix(matrixA);
                let B = math.matrix([vectorB]);

                // Calculate inverse of A
                const A_inv = math.inv(A);

                // Calculate B_k
                let B_current = B;
                for (let i = 0; i < k; i++) {
                    B_current = math.multiply(B_current, A_inv);
                }

                // Display result
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = `<h3>Result (B_${k}):</h3>`;
                resultDiv.innerHTML += `<pre>${math.format(B_current, {precision: 6})}</pre>`;
                resultDiv.className = '';
            } catch (error) {
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
                resultDiv.className = 'error';
            }
        }
    </script>
</body>
</html>